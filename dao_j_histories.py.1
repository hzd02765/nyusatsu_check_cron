# -*- coding: utf-8 -*-

# import util

import datetime

import dao_pg_connection
import logger

# def update_history(conn, cur):
	# sql = "insert into histories (modified) values (now())"
	# util.print_log("SQL : " + sql)
	# cur.execute(sql)
	# conn.commit()

class DaoJHistories:
	def __init__(self):
		self.sql = ""
	
	def make_sql(self):
		self.sql = "insert into j_histories (process_end) values (now())"
	
	def get_sql(self):
		return  self.sql
	
	def exec_sql(self, conn, cur):
		cur.execute(self.sql)
		conn.commit()

# テスト用
if __name__ == '__main__':
	file_name = "access_log_" + datetime.datetime.now().strftime("%Y-%m-%d") + ".log"
	logger = logger.Logger(file_name)
	# print(logger.file_path)
	
	pg_connection = dao_pg_connection.PgConnection()
	pg_connection.set_pg_connection_open(logger)
	connection = pg_connection.get_pg_connection()
	cursor = connection.cursor()
	
	dao_histories = DaoJHistories()
	dao_histories.make_sql()
	logger.set_log(dao_histories.get_sql())
	dao_histories.exec_sql(connection, cursor)
	
	pg_connection.set_pg_connection_close(cursor, logger)
	
	logger.print_log()